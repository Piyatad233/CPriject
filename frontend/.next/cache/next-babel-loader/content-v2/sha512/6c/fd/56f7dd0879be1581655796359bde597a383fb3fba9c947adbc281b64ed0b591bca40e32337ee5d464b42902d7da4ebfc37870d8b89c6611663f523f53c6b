{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\client\\\\lab8\\\\Lab08\\\\next-nodejs-auth\\\\frontend\\\\pages\\\\herolist.js\";\nimport axios from \"axios\";\nimport React, { useState, useEffect } from \"react\";\nimport styles from \"../styles/student.module.css\";\nimport withAuth from \"../components/withAuth\";\nimport Navbar from \"../components/navbar\";\nconst URL = \"http://localhost/api/herolists\";\n\nconst admin = ({\n  token\n}) => {\n  const {\n    0: user,\n    1: setUser\n  } = useState({});\n  const {\n    0: herolists,\n    1: setHerolists\n  } = useState({});\n  const {\n    0: name,\n    1: setName\n  } = useState(\"\");\n  const {\n    0: status,\n    1: setStatus\n  } = useState(\"\");\n  const {\n    0: rank,\n    1: setRank\n  } = useState(\"\");\n  const {\n    0: number,\n    1: setNumber\n  } = useState(\"\");\n  const {\n    0: herolist,\n    1: setHerolist\n  } = useState({});\n  const {\n    0: imgeurl,\n    1: setImageUrl\n  } = useState(\"\");\n  useEffect(() => {\n    getHerolists();\n    profileUser();\n  }, []);\n\n  const profileUser = async () => {\n    try {\n      const users = await axios.get(`${config.URL}/profile`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setUser(users.data);\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  const getHerolist = async id => {\n    const result = await axios.get(`${URL}/${id}`);\n    console.log('herolist id: ', result.data);\n    setHerolist(result.data);\n  };\n\n  const getHerolists = async () => {\n    let result = await axios.get(URL);\n    setHerolists(result.data.list);\n  };\n\n  const addHerolist = async () => {\n    let result = await axios.post(URL, {\n      name,\n      status,\n      rank,\n      number,\n      imgeurl\n    });\n    console.log(result);\n    getHerolists();\n  };\n\n  const deleteHerolist = async id => {\n    let result = await axios.delete(`${URL}/${id}`);\n    getHerolists();\n  };\n\n  const updateHerolist = async id => {\n    let result = await axios.put(`${URL}/${id}`, {\n      name,\n      status,\n      rank,\n      number,\n      imgeurl\n    });\n    console.log(result);\n    getHerolists();\n  };\n\n  const handleUpload = async e => {\n    const images = this.state.images;\n    const filesUpload = e.target.files;\n    const allImages = Object.keys(filesUpload).map(async key => {\n      return new Promise((resolve, reject) => {\n        let reader = new FileReader();\n        reader.readAsDataURL(filesUpload[key]);\n\n        reader.onload = () => {\n          let dataURI = reader.result;\n          let base64 = dataURI.replace(/^[^,]+,/, '');\n          let byteCharacters = atob(base64);\n          let byteNumbers = new Uint8Array(byteCharacters.length);\n\n          for (var i = 0; i < byteCharacters.length; i++) {\n            byteNumbers[i] = byteCharacters.charCodeAt(i);\n          }\n\n          let blob = new Blob([byteNumbers], {\n            type: 'image/jpeg'\n          });\n          let urlCreator = window.URL || window.webkitURL;\n          let imageUrl = urlCreator.createObjectURL(blob);\n          let imageDetail = {\n            url: imageUrl,\n            fileUpload: filesUpload[key]\n          };\n          resolve(imageDetail);\n        };\n      });\n    });\n    const data = await Promise.all(allImages);\n    this.setState({\n      images: images.concat(data)\n    });\n  };\n\n  const renderImages = async e => {\n    const {\n      images\n    } = this.state;\n\n    if (this.state.images.length > 0) {\n      return this.state.images.map((image, index) => {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: image.url,\n            width: 200\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              images.splice(index, 1);\n              this.setState({\n                images\n              });\n            },\n            children: \"\\u0E25\\u0E1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 13\n          }, this)]\n        }, image.url, true, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this);\n      });\n    }\n  };\n\n  const showHerolist = () => {\n    if (herolists && herolists.length) {\n      return herolists.map((item, index) => {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.listItem,\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Picture\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 13\n          }, this), this.renderImages(), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 48\n          }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Name:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 13\n          }, this), \" \", item.name, \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 38\n          }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Status:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 13\n          }, this), \" \", item.status, \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 42\n          }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Rank:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }, this), \" \", item.rank, \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 38\n          }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Number:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 13\n          }, this), \" \", item.number, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 41\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.edit_button,\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: styles.button_get,\n              onClick: () => getHerolist(item.id),\n              children: \"Get\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: styles.button_update,\n              onClick: () => updateHerolist(item.id),\n              children: \"Update\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: styles.button_delete,\n              onClick: () => deleteHerolist(item.id),\n              children: \"Delete\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 148,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 13\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this);\n      });\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 14\n      }, this);\n    }\n  };\n\n  const handlerChangeFile = e => {\n    const reader = new FileReader();\n\n    reader.onload = e => {\n      setImageUrl(e.target.result);\n    };\n\n    if (e.target.files[0]) reader.readAsDataURL(e.target.files[0]);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.container,\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: /*#__PURE__*/_jsxDEV(\"ins\", {\n        children: \"Hero Data Edit \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.form_add,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Add Hero\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this), \"Name:\", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"name\",\n        onChange: e => setName(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 9\n      }, this), \"Status:\", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"status\",\n        onChange: e => setStatus(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 9\n      }, this), \"Rank:\", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"rank\",\n        onChange: e => setRank(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 9\n      }, this), \"Number:\", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"number\",\n        onChange: e => setNumber(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        name: \"uploadAwsS3\",\n        onChange: e => handleUpload(e.target.value),\n        accept: \"image/*\",\n        multiple: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: styles.button_add,\n        onClick: () => addHerolist(name, status, rank, number, imgeurl),\n        children: \"Add\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.list,\n      children: showHerolist()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.list1,\n      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          children: /*#__PURE__*/_jsxDEV(\"ins\", {\n            children: \"(selected Hero)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 43\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 40\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 37\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"  Name:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 78\n      }, this), herolists.name, /*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"  Status:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 108\n      }, this), herolists.status, \" \", /*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"  Rank:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 143\n      }, this), herolists.rank, \"  \", /*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"Number:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 175\n      }, this), herolists.number, \" \", /*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"Picture:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 208\n      }, this), herolists.imgeurl]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 174,\n    columnNumber: 5\n  }, this);\n};\n\nexport default withAuth(admin);\nexport function getServerSideProps({\n  req,\n  res\n}) {\n  return {\n    props: {\n      token: req.cookies.token || \"\"\n    }\n  };\n}","map":{"version":3,"sources":["D:/client/lab8/Lab08/next-nodejs-auth/frontend/pages/herolist.js"],"names":["axios","React","useState","useEffect","styles","withAuth","Navbar","URL","admin","token","user","setUser","herolists","setHerolists","name","setName","status","setStatus","rank","setRank","number","setNumber","herolist","setHerolist","imgeurl","setImageUrl","getHerolists","profileUser","users","get","config","headers","Authorization","data","e","console","log","getHerolist","id","result","list","addHerolist","post","deleteHerolist","delete","updateHerolist","put","handleUpload","images","state","filesUpload","target","files","allImages","Object","keys","map","key","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","dataURI","base64","replace","byteCharacters","atob","byteNumbers","Uint8Array","length","i","charCodeAt","blob","Blob","type","urlCreator","window","webkitURL","imageUrl","createObjectURL","imageDetail","url","fileUpload","all","setState","concat","renderImages","image","index","splice","showHerolist","item","listItem","edit_button","button_get","button_update","button_delete","handlerChangeFile","container","form_add","value","button_add","list1","getServerSideProps","req","res","props","cookies"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport styles from \"../styles/student.module.css\";\r\nimport withAuth from \"../components/withAuth\";\r\nimport Navbar from \"../components/navbar\";\r\n\r\nconst URL = \"http://localhost/api/herolists\";\r\nconst admin = ({ token }) => {\r\n  const [user, setUser] = useState({});\r\n  const [herolists, setHerolists] = useState({});\r\n  const [name, setName] = useState(\"\");\r\n  const [status, setStatus] = useState(\"\");\r\n  const [rank, setRank] = useState(\"\");\r\n  const [number, setNumber] = useState(\"\");\r\n  const [herolist, setHerolist] = useState({});\r\n  const [imgeurl, setImageUrl] = useState(\"\");\r\n  useEffect(() => {\r\n    getHerolists();\r\n    profileUser();\r\n  }, []);\r\n  const profileUser = async () => {\r\n    try {\r\n      \r\n      const users = await axios.get(`${config.URL}/profile`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n     \r\n      setUser(users.data);\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  };\r\n\r\n  const getHerolist = async (id) => {\r\n    const result = await axios.get(`${URL}/${id}`)\r\n    console.log('herolist id: ', result.data)\r\n    setHerolist(result.data)\r\n}\r\n \r\n  const getHerolists = async () => {\r\n    let result = await axios.get(URL);\r\n    setHerolists(result.data.list);\r\n  };\r\n\r\n  const addHerolist = async () => {\r\n    let result = await axios.post(URL, {\r\n      name,\r\n      status,\r\n      rank,\r\n      number,\r\n      imgeurl\r\n    });\r\n    console.log(result);\r\n    getHerolists();\r\n  };\r\n\r\n  const deleteHerolist = async (id) => {\r\n    let result = await axios.delete(`${URL}/${id}`);\r\n    getHerolists();\r\n  };\r\n\r\n  const updateHerolist = async (id) => {\r\n    let result = await axios.put(`${URL}/${id}`, {\r\n      name,\r\n      status,\r\n      rank,\r\n      number,\r\n      imgeurl\r\n    });\r\n    console.log(result);\r\n    getHerolists();\r\n  };\r\n\r\n  const handleUpload = async (e) => {\r\n    const images = this.state.images\r\n    const filesUpload = e.target.files\r\n    const allImages = Object.keys(filesUpload).map(async key => {\r\n      return new Promise((resolve, reject) => {\r\n        let reader = new FileReader()\r\n        reader.readAsDataURL(filesUpload[key])\r\n        reader.onload = () => {\r\n          let dataURI = reader.result\r\n          let base64 = dataURI.replace(/^[^,]+,/, '')\r\n          let byteCharacters = atob(base64)\r\n          let byteNumbers = new Uint8Array(byteCharacters.length)\r\n \r\n          for (var i = 0; i < byteCharacters.length; i++) {\r\n            byteNumbers[i] = byteCharacters.charCodeAt(i)\r\n          }\r\n          let blob = new Blob([byteNumbers], { type: 'image/jpeg' })\r\n          let urlCreator = window.URL || window.webkitURL\r\n          let imageUrl = urlCreator.createObjectURL(blob)\r\n          let imageDetail = {\r\n            url: imageUrl,\r\n            fileUpload: filesUpload[key]\r\n          }\r\n          resolve(imageDetail)\r\n        }\r\n      })\r\n    })\r\n    const data = await Promise.all(allImages)\r\n    this.setState({ images: images.concat(data) })\r\n  }\r\n  \r\n  const  renderImages = async (e) => {\r\n    const { images } = this.state\r\n    if (this.state.images.length > 0) {\r\n      return this.state.images.map((image, index) => {\r\n        return (\r\n          <div key={image.url}>\r\n            <img src={image.url} width={200} />\r\n            <button onClick={() => {\r\n              images.splice(index, 1)\r\n              this.setState({images})\r\n            }}>\r\n              ลบ\r\n            </button>\r\n          </div>\r\n        )\r\n      })\r\n    }\r\n  }\r\n  \r\n  const showHerolist = () => {\r\n    if (herolists && herolists.length) {\r\n      return herolists.map((item, index) => {\r\n        return (\r\n          <div className={styles.listItem} key={index}>\r\n            <b>Picture</b>{this.renderImages()}<br />\r\n            <b>Name:</b> {item.name} <br />\r\n            <b>Status:</b> {item.status} <br />\r\n            <b>Rank:</b> {item.rank} <br />\r\n            <b>Number:</b> {item.number}<br />\r\n            \r\n            <div className={styles.edit_button}>\r\n              <button\r\n                className={styles.button_get}\r\n                onClick={() => getHerolist(item.id)}\r\n              >\r\n                Get\r\n              </button>\r\n              <button\r\n                className={styles.button_update}\r\n                onClick={() => updateHerolist(item.id)}\r\n              >\r\n                Update\r\n              </button>\r\n              <button\r\n                className={styles.button_delete}\r\n                onClick={() => deleteHerolist(item.id)}\r\n              >\r\n                Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n        );\r\n      });\r\n    } else {\r\n      return <p>Loading...</p>;\r\n    }\r\n  };\r\n\r\n  const handlerChangeFile = e =>{\r\n    const reader = new FileReader();\r\n\r\n      reader.onload = e => {\r\n          setImageUrl(e.target.result);\r\n      }\r\n      if(e.target.files[0])\r\n        reader.readAsDataURL(e.target.files[0]);\r\n  }\r\n\r\n  return (\r\n    <div className={styles.container}>\r\n      <Navbar />\r\n      <h1><ins>Hero Data Edit </ins></h1>\r\n      <div className={styles.form_add}>\r\n        <h2>Add Hero</h2>\r\n        Name:\r\n        <input\r\n          type=\"text\"\r\n          name=\"name\"\r\n          onChange={(e) => setName(e.target.value)}\r\n        ></input>\r\n        Status:\r\n        <input\r\n          type=\"text\"\r\n          name=\"status\"\r\n          onChange={(e) => setStatus(e.target.value)}\r\n        ></input>\r\n        Rank:\r\n        <input\r\n          type=\"text\"\r\n          name=\"rank\"\r\n          onChange={(e) => setRank(e.target.value)}\r\n        ></input>\r\n        Number:\r\n        <input\r\n          type=\"text\"\r\n          name=\"number\"\r\n          onChange={(e) => setNumber(e.target.value)}\r\n        ></input>\r\n        <input\r\n          type='file'\r\n          name='uploadAwsS3'\r\n          onChange= {(e) => handleUpload(e.target.value)}\r\n          accept='image/*' multiple\r\n        />\r\n        <button\r\n          className={styles.button_add}\r\n          onClick={() => addHerolist(name, status, rank, number,imgeurl)}\r\n        >\r\n          Add\r\n        </button>\r\n      </div>\r\n    \r\n      <div className={styles.list}>{showHerolist()}</div>\r\n    \r\n      <div className={styles.list1}><b><i><ins>(selected Hero)</ins></i></b> <b>  Name:</b>{herolists.name}<b>  Status:</b>{herolists.status} <b>  Rank:</b>{herolists.rank}  <b>Number:</b>{herolists.number} <b>Picture:</b>{herolists.imgeurl}</div>\r\n    </div>\r\n  );\r\n};\r\nexport default withAuth(admin);\r\n\r\nexport function getServerSideProps({ req, res }) {\r\n  return { props: { token: req.cookies.token || \"\" } };\r\n}\r\n"]},"metadata":{},"sourceType":"module"}